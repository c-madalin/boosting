<div class="page">
  <div class="page-header">
    <h1>Boosting Dashboard</h1>

    <div class="top-actions">
      <!-- Bell + dropdown -->
      <div class="notif-wrap" (mouseenter)="openNotif()" (mouseleave)="closeNotif()">
        <button type="button" class="bell" (click)="toggleNotifDropdown()">
  <span class="bell__icon">
    <i class="fa-regular fa-bell"></i>
  </span>
  <span class="bell__text">
    <span class="t1">Notifications</span>
    <span class="t2">{{ notifItems.length }} new</span>
  </span>
</button>


        <!-- Dropdown mini -->
        <div class="notif-panel small" *ngIf="notifOpen">
          <div class="notif-panel__arrow"></div>

          <header class="np-header">
            <div class="np-title">Notifications</div>
            <div class="np-actions">
              <button type="button" class="chip">READ ALL</button>
              <button type="button" class="ghost">Mute</button>
              <button type="button" class="icon" (click)="closeNotif()">✕</button>
            </div>
          </header>

          <div class="np-list">
            <button
              class="np-row"
              *ngFor="let n of notifItems; trackBy: trackByNotif"
              (click)="onOpenFromDropdown(n)">
              <div class="row-line1">
                <div class="row-title">{{ n.offer.gameName }}</div>
                <div class="row-sub">{{ n.subtitle }} • {{ n.time }}</div>
              </div>
              <div class="row-line2">
                <span>Current: <b>{{ n.offer.currentRank }}</b></span>
                <span>Desired: <b>{{ n.offer.desiredRank }}</b></span>
                <span>RP: <b>{{ n.offer.currentRP }}</b></span>
                <span>Price: <b>{{ n.offer.priceUSD }}$</b></span>
              </div>
            </button>
            <div class="np-empty" *ngIf="!notifItems.length">No notifications</div>
          </div>

          <footer class="np-footer">
            <button type="button" class="view-all" (click)="onViewAll()">VIEW ALL</button>
          </footer>
        </div>
      </div>

      <!-- switch Get Boosting Offers -->
      <label class="switch">
        <input type="checkbox" [(ngModel)]="offersEnabled" />
        <span class="slider"></span>
        <span class="label">Get Boosting Offers</span>
      </label>
    </div>
  </div>

  <!-- SEARCH + FILTRE -->
  <app-search-bar (searchChange)="onSearch($event)" (viewClick)="onViewClick()">
    <app-filter-button filters label="+ Status"
      [options]="statusOptions" [selected]="filters.status"
      (selectedChange)="onStatusChange($event)">
    </app-filter-button>

    <app-filter-button filters label="+ Date"
      [options]="dateOptions" [multiple]="false"
      [selected]="datePreset" (selectedChange)="onDatePresetChange($event)">
    </app-filter-button>
  </app-search-bar>

  <!-- TABEL -->
  <app-boosting-table [rows]="rows" (rowAction)="onRowAction($event)"></app-boosting-table>
</div>

<!-- OVERLAY: notifications panel -->
<app-overlay [open]="showNotifPanel" (backdropClick)="onPanelClose()">
  <app-notifications-panel
    [items]="notifItems"
    (take)="onPanelTake($event)"
    (ignore)="onPanelIgnore($event)"
    (close)="onPanelClose()"/>
</app-overlay>

<!-- OVERLAY: boost offer alert (centrat) -->
<app-overlay [open]="showOffer" (backdropClick)="closeOffer()">
  <app-boost-offer-alert
    *ngIf="selectedOffer"
    [offer]="selectedOffer"
    (decline)="onDecline()"
    (counter)="onCounter()"
    (accept)="onAccept()"/>
</app-overlay>
